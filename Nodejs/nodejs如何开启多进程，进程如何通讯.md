## nodejs如何开启多进程，进程如何通讯

进程： 操作系统进行资源分配和调度的最小单位，有独立内存空间
线程： 操作系统进行运算调度的最小单位， 共享进程内存空间

线程是进程的一个执行流,是CPU调度和分派的基本单位,它是比进程更小的能独立运行的基本单位。一个进程由几个线程组成,线程与同属一个进程的其他的线程共享进程所拥有的全部资源

nodejs 是单线程的, 在处理 http 请求的时候 一个错误会导致整个进程的退出, 这是致命的问题;
但是可以开器多进程执行，如 WebWorker

### 为什么需要多进程

多核 CPU, 更适合处理多进程
内存较大， 多个进程才能更好的利用（单进程有内存上限）
充分利用机器资源，使我们的应用更快

### nodejs 中开启多进程

child_process 子进程

常用的一些方法:
exec(): 异步衍生出一个 shell, 然后再 shell 中执行命令，且缓冲认为产生的输出，运行结束后调用回调函数

spawn：处理一些会有很多子进程 I/O 时、进程会有大量输出时使用
execFile：只需执行一个外部程序的时候使用，执行速度快，处理用户输入相对安全
exec：想直接访问线程的 shell 命令时使用，异步衍生出一个 shell, 然后再 shell 中执行命令，且缓冲认为产生的输出，运行结束后调用回调函数，一定要注意用户输入
fork：想将一个 Node 进程作为一个独立的进程来运行的时候使用，是的计算处理和文件描述器脱离 Node 主进程


cluster 集群 （基于 child_process 封装）
解决 NodeJS 单进程无法充分利用多核 CPU 问题
    通过 master-cluster 模式可以使得应用更加健壮
    Cluster 底层是 child_process 模块，除了可以发送普通消息，还可以发送底层对象 TCP、UDP 等
    TCP 主进程发送到子进程，子进程能根据消息重建出 TCP 连接，Cluster 可以决定 fork 出合适的硬件资源的子进程数
